library(forecast)
library(readxl)
setwd("D:/minque/Magistro darbas/Code")
rm(list = ls())
library(nlme)
library(plyr)
library(gdata)
library(lme4)
library(mitools)
library(lmerTest)
library(robustlmm)
library(foreach)
library(Matrix)
library(gtools)
library(snow)
library(matrixcalc)
library(mitools)
library(MASS)
library(snow)
library(boot)
library(plyr)
library(mvtnorm)
library(expm)
library(simFrame)
library(foreach)
library(msm)
library(gtools)
library(MASS)
library(lme4)
library(gdata)
library(Matrix)
library(data.table)
library(ggplot2)
source("10code.R")
load("data.2011.RData")
############################################################################
varb <- c("IDSTUD", "IDSCHOOL", "IDCLASS", "SSEX", "STHMWRK2", "SMENG", "SMCONF", "SMVALUE",
"MSMENG", "MSMCONF", "MSMVALUE", "CSMENG", "CSMCONF", "CSMVALUE",
"SMLIKE", "SBULLED", "SHEDRES", "TPROBL", "TAKADSEKM", "TMOKAPL", "KDYDIS",
"CSMLIKE", "CSBULLED", "CSHEDRES", "MKDYDIS", "MKITKALB2",
"MSMLIKE", "MSBULLED", "MSHEDRES", "MTPROBL", "MTAKADSEKM", "MTMOKAPL", "MKDYDIS",
"TSATISF", "TBENDR", "TENGAGE", "TLYTIS", "TISSIL2", "TISSIL.1",
"MTSATISF", "MTBENDR", "MTENGAGE",
"TISSIL.2", "TISSIL.3", "TPATIR", "TAMZIUS2", "TAMZIUS.1", "TAMZIUS.2",
"TAMZIUS.3", "KDYDIS", "MDYDIS", "MSUDET2", "MSUDET.1", "MSUDET.2",
"MSUDET.3", "MDISSAFE", "MSUCCESS", "MMATSHORT", "MAINCOME", "MAINCOME.1",
"MAINCOME.2", "MAINCOME.3", "MVIETA2", "MVIETA.1", "MVIETA.2", "MVIETA.3",
"MVIETA.4", "MVIETA.5", "MKITKALB2", "MKITKALB.1", "MKITKALB.2", "MKITKALB.3",
"MINSTRHWR", "STUDWGT", "SCHWGT", "TOTWGT", "WGTADJ1", "WGTADJ2", "WGTADJ3",
"WGTFAC1", "WGTFAC2", "WGTFAC3", "IDSTRATE")
data.2011 <- data.2011[,c("BSMMAT01", varb), , with = F]
p <- ggplot(data=as.data.frame(qqnorm(data.2011$BSMMAT01, plot=F)), mapping=aes(x=x, y=y)) +
geom_point() + geom_smooth(method="lm", se=FALSE)+labs(x="Teoriniai kvantiliai", y = "Matematikos rezultatas")
pdf("Output/teorkv.pdf", width = 10)
p
dev.off()
varbs <- c("IDSTUD", "IDSCHOOL", "IDCLASS", "SSEX", "STHMWRK2", "SMENG", "SMCONF",
"SMVALUE",
"MSMENG", "MSMCONF", "MSMVALUE", "CSMENG", "CSMCONF", "CSMVALUE",
"SMLIKE", "SBULLED", "SHEDRES",
"CSMLIKE", "CSBULLED", "CSHEDRES",
"MSMLIKE", "MSBULLED", "MSHEDRES",
"MDYDIS", "MSUDET2", "MSUDET.1", "MSUDET.2",
"MSUDET.3", "MAINCOME", "MAINCOME.1",
"MAINCOME.2", "MAINCOME.3", "MVIETA2", "MVIETA.1", "MVIETA.2",
"MVIETA.3", "MSUCCESS",#"MMATSHORT",
"MVIETA.4", "MVIETA.5",
"STUDWGT", "SCHWGT", "TOTWGT", "WGTADJ1", "WGTADJ2", "WGTADJ3",
"WGTFAC1", "WGTFAC2", "WGTFAC3", "IDSTRATE")
data.2011 <- drop.levels(na.omit(data.2011[,c("BSMMAT01", varbs), with = F]))
########################################
# NULL MODEL
########################################
lme.0 <-lmer(BSMMAT01 ~ 1+(1|IDSCHOOL), data = data.2011, REML = T)
(sm0 <- summary(lme.0))
c0 <- confint(lme.0, method = "boot")
c0[1:2, ] <- c0[1:2, ]^2
varbs <- c("IDSTUD", "IDSCHOOL", "IDCLASS", "SSEX", "STHMWRK2", "MVIETA.5",
"CSMCONF", "CSHEDRES", "MDYDIS", "CSHEDRES",
"CSBULLED", "MVIETA.3", "MSUCCESS", "MVIETA.4",
"MSMLIKE", "MSHEDRES", "MAINCOME.1",
"STUDWGT", "SCHWGT", "TOTWGT", "WGTADJ1", "WGTADJ2", "WGTADJ3",
"WGTFAC1", "WGTFAC2", "WGTFAC3", "IDSTRATE")
data.2011 <- drop.levels(na.omit(data.2011[,c("BSMMAT01", varbs), with = F]))
rb0 <- try(bootREML(data = data.2011, R = 2,
form = "BSMMAT01 ~ 1+SSEX+STHMWRK2:MVIETA.5+
CSMCONF+CSHEDRES*MDYDIS+CSHEDRES:MVIETA.5+
CSBULLED:MVIETA.3+
MDYDIS+
MSUCCESS:MVIETA.4+
MSMLIKE:MVIETA.5+MSMLIKE:MVIETA.4+#:as.factor(MVIETA2)+
MSHEDRES+
MAINCOME.1+MVIETA.4+
(1+CSHEDRES+CSMCONF|IDSCHOOL)", idstrata = "IDSTRATE"))
debug(bootMINQUE2)
mw1 <- try(bootMINQUE2(data = data.2011, R = 2,
fixed = "BSMMAT01 ~ 1+SSEX+STHMWRK2:MVIETA.5+
CSMCONF+CSHEDRES*MDYDIS+CSHEDRES:MVIETA.5+
CSBULLED:MVIETA.3+MDYDIS+MSUCCESS:MVIETA.4+
MSMLIKE:MVIETA.5+MSMLIKE:MVIETA.4+
MSHEDRES+MAINCOME.1+MVIETA.4",
random="~1+CSHEDRES+CSMCONF|IDSCHOOL", idstrata = "IDSTRATE", wgt = NULL))
t0
fixed
random
weights = wgt
dt=data
random1=random
N <- nrow(dt)
# Form Y and fixed effects data frame
ff <- model.matrix(as.formula(fixed), model.frame(fixed, dt))
Y <- as(as(model.frame(fixed, dt)[,1, drop = F], "matrix"), "Matrix")
if (grepl("-1",fixed)) {
X <- as(as(ff[,-1, drop = F], "matrix"), "Matrix")
} else {
X <- as(as(ff, "matrix"), "Matrix")
}
grepl("-1",fixed)
X <- as(as(ff, "matrix"), "Matrix")
!is.null(random1)
id1 <- strsplit(random1, "\\|")
random1 <- unlist(id1)[1]
nmid1 <- unlist(id1)[2]
rr1 <- model.frame(random1, dt)
id1 <- model.frame(paste("~", nmid1), dt)[,1]
!is.null(weights)
weights
wg <- as.data.frame(dt[,c(nmid1, weights), with = F])
wg <- foreach(ii = unique(id1)) %do% {x <- wg[id1 %in% ii, , drop = F];x[,2] <- x[,2]*nrow(x)/sum(x[,2]);return(x)}
swg <- Reduce("+", llply(wg, function(x) unique(x[,3])))
ff <- model.matrix(as.formula(fixed), model.frame(fixed, dt))
Y <- as(as(model.frame(fixed, dt)[,1, drop = F], "matrix"), "Matrix")
wg <- foreach(ii = unique(id1)) %do% {sum(id1 %in% ii)}
wgt1i <- llply(wg, function(x) rep(1, x))
wgt2i <- llply(wg, function(x) rep(1, x))
wgt12i <- llply(wg, function(x) rep(1, x))
grepl("-1",random1)
Z1 <- as(as(cbind(matrix(1, ncol = 1, nrow = nrow(rr1),
dimnames = list(NULL, "(Intercept)")), rr1), "matrix"),
"Matrix")
q <- ncol(Z1)
colnames(Z1) <- paste(nmid1, colnames(Z1), sep = ".")
clnms1 <- colnames(Z1)
Z1 <- foreach(i = unique(id1)) %do% {Z1[id1 %in% i, ,drop = F]}
Z1 <- mapply(function(z, w) {z*1/sqrt(w)}, Z1, wgt2i)
Z <- bdiag(Z1)
n1 <- length(unique(id1))
l <- q*(q+1)/2
TT1 <- formTT(q)
QI <- llply(TT1, function(tt) llply(Z1, function(z) z%*%tt%*%t(z)))
l <- l+1
Qj <- c(list(llply(QI[[1]], function(zj) diag(nrow(zj)))), QI)
Qj[[1]] <- foreach(i = 1:length(Qj[[1]])) %do% {1/wgt12i[[i]]*Qj[[1]][[i]]}
QI <- llply(Qj, function(x) bdiag(x))
Xj <- foreach(i = unique(id1)) %do% {X[id1 %in% i, ,drop = F]}
X <- as(foreach(ii = 1:length(Xj), .combine = rbind) %do% as.matrix(Xj[[ii]]), "Matrix")
Yj <- foreach(i = unique(id1)) %do% {Y[id1 %in% i,,drop = F]}
Y <- as(foreach(ii = 1:length(Xj), .combine = rbind) %do% as.matrix(Yj[[ii]]), "Matrix")
is.null(apriori)) apriori <- rep(1, length(QI)
if (is.null(apriori)) apriori <- rep(1, length(QI))
apriori = NULL
if (is.null(apriori)) apriori <- rep(1, length(QI))
Vj <- foreach(i = 1:length(unique(id1))) %do% solve(Reduce("+", mapply(function(qj, th) th*qj[[i]], Qj, apriori)))
Vj <- foreach(i = 1:length(unique(id1))) %do% solve(Reduce("+", mapply(function(qj, th) th*qj[[i]], Qj, apriori)))
V <- bdiag(Vj)
iM <- iMINQUE(V, X, Y, QI, wgt2i)
setwd("D:/minque/Magistro darbas/Code")
rm(list = ls())
library(nlme)
library(plyr)
library(gdata)
library(lme4)
library(mitools)
library(lmerTest)
library(robustlmm)
library(foreach)
library(Matrix)
library(gtools)
library(snow)
library(matrixcalc)
library(mitools)
library(MASS)
library(snow)
library(boot)
library(plyr)
library(mvtnorm)
library(expm)
library(simFrame)
library(foreach)
library(msm)
library(gtools)
library(MASS)
library(lme4)
library(gdata)
library(Matrix)
library(data.table)
library(ggplot2)
source("10code.R")
load("data.2011.RData")
varb <- c("IDSTUD", "IDSCHOOL", "IDCLASS", "SSEX", "STHMWRK2", "SMENG", "SMCONF", "SMVALUE",
"MSMENG", "MSMCONF", "MSMVALUE", "CSMENG", "CSMCONF", "CSMVALUE",
"SMLIKE", "SBULLED", "SHEDRES", "TPROBL", "TAKADSEKM", "TMOKAPL", "KDYDIS",
"CSMLIKE", "CSBULLED", "CSHEDRES", "MKDYDIS", "MKITKALB2",
"MSMLIKE", "MSBULLED", "MSHEDRES", "MTPROBL", "MTAKADSEKM", "MTMOKAPL", "MKDYDIS",
"TSATISF", "TBENDR", "TENGAGE", "TLYTIS", "TISSIL2", "TISSIL.1",
"MTSATISF", "MTBENDR", "MTENGAGE",
"TISSIL.2", "TISSIL.3", "TPATIR", "TAMZIUS2", "TAMZIUS.1", "TAMZIUS.2",
"TAMZIUS.3", "KDYDIS", "MDYDIS", "MSUDET2", "MSUDET.1", "MSUDET.2",
"MSUDET.3", "MDISSAFE", "MSUCCESS", "MMATSHORT", "MAINCOME", "MAINCOME.1",
"MAINCOME.2", "MAINCOME.3", "MVIETA2", "MVIETA.1", "MVIETA.2", "MVIETA.3",
"MVIETA.4", "MVIETA.5", "MKITKALB2", "MKITKALB.1", "MKITKALB.2", "MKITKALB.3",
"MINSTRHWR", "STUDWGT", "SCHWGT", "TOTWGT", "WGTADJ1", "WGTADJ2", "WGTADJ3",
"WGTFAC1", "WGTFAC2", "WGTFAC3", "IDSTRATE")
data.2011 <- data.2011[,c("BSMMAT01", varb), , with = F]
p <- ggplot(data=as.data.frame(qqnorm(data.2011$BSMMAT01, plot=F)), mapping=aes(x=x, y=y)) +
geom_point() + geom_smooth(method="lm", se=FALSE)+labs(x="Teoriniai kvantiliai", y = "Matematikos rezultatas")
pdf("Output/teorkv.pdf", width = 10)
p
dev.off()
varbs <- c("IDSTUD", "IDSCHOOL", "IDCLASS", "SSEX", "STHMWRK2", "SMENG", "SMCONF",
"SMVALUE",
"MSMENG", "MSMCONF", "MSMVALUE", "CSMENG", "CSMCONF", "CSMVALUE",
"SMLIKE", "SBULLED", "SHEDRES",
"CSMLIKE", "CSBULLED", "CSHEDRES",
"MSMLIKE", "MSBULLED", "MSHEDRES",
"MDYDIS", "MSUDET2", "MSUDET.1", "MSUDET.2",
"MSUDET.3", "MAINCOME", "MAINCOME.1",
"MAINCOME.2", "MAINCOME.3", "MVIETA2", "MVIETA.1", "MVIETA.2",
"MVIETA.3", "MSUCCESS",#"MMATSHORT",
"MVIETA.4", "MVIETA.5",
"STUDWGT", "SCHWGT", "TOTWGT", "WGTADJ1", "WGTADJ2", "WGTADJ3",
"WGTFAC1", "WGTFAC2", "WGTFAC3", "IDSTRATE")
data.2011 <- drop.levels(na.omit(data.2011[,c("BSMMAT01", varbs), with = F]))
lme.0 <-lmer(BSMMAT01 ~ 1+(1|IDSCHOOL), data = data.2011, REML = T)
(sm0 <- summary(lme.0))
c0 <- confint(lme.0, method = "boot")
c0[1:2, ] <- c0[1:2, ]^2
rb01 <- try(bootREML(data = data.2011, R = 5,
form = "BSMMAT01 ~ 1+
(1|IDSCHOOL)", idstrata = "IDSTRATE"))
setwd("D:/minque/Magistro darbas/Code")
rm(list = ls())
library(nlme)
library(plyr)
library(gdata)
library(lme4)
library(mitools)
library(lmerTest)
library(robustlmm)
library(foreach)
library(Matrix)
library(gtools)
library(snow)
library(matrixcalc)
library(mitools)
library(MASS)
library(snow)
library(boot)
library(plyr)
library(mvtnorm)
library(expm)
library(simFrame)
library(foreach)
library(msm)
library(gtools)
library(MASS)
library(lme4)
library(gdata)
library(Matrix)
library(data.table)
library(ggplot2)
source("10code.R")
load("data.2011.RData")
############################################################################
varb <- c("IDSTUD", "IDSCHOOL", "IDCLASS", "SSEX", "STHMWRK2", "SMENG", "SMCONF", "SMVALUE",
"MSMENG", "MSMCONF", "MSMVALUE", "CSMENG", "CSMCONF", "CSMVALUE",
"SMLIKE", "SBULLED", "SHEDRES", "TPROBL", "TAKADSEKM", "TMOKAPL", "KDYDIS",
"CSMLIKE", "CSBULLED", "CSHEDRES", "MKDYDIS", "MKITKALB2",
"MSMLIKE", "MSBULLED", "MSHEDRES", "MTPROBL", "MTAKADSEKM", "MTMOKAPL", "MKDYDIS",
"TSATISF", "TBENDR", "TENGAGE", "TLYTIS", "TISSIL2", "TISSIL.1",
"MTSATISF", "MTBENDR", "MTENGAGE",
"TISSIL.2", "TISSIL.3", "TPATIR", "TAMZIUS2", "TAMZIUS.1", "TAMZIUS.2",
"TAMZIUS.3", "KDYDIS", "MDYDIS", "MSUDET2", "MSUDET.1", "MSUDET.2",
"MSUDET.3", "MDISSAFE", "MSUCCESS", "MMATSHORT", "MAINCOME", "MAINCOME.1",
"MAINCOME.2", "MAINCOME.3", "MVIETA2", "MVIETA.1", "MVIETA.2", "MVIETA.3",
"MVIETA.4", "MVIETA.5", "MKITKALB2", "MKITKALB.1", "MKITKALB.2", "MKITKALB.3",
"MINSTRHWR", "STUDWGT", "SCHWGT", "TOTWGT", "WGTADJ1", "WGTADJ2", "WGTADJ3",
"WGTFAC1", "WGTFAC2", "WGTFAC3", "IDSTRATE")
data.2011 <- data.2011[,c("BSMMAT01", varb), , with = F]
p <- ggplot(data=as.data.frame(qqnorm(data.2011$BSMMAT01, plot=F)), mapping=aes(x=x, y=y)) +
geom_point() + geom_smooth(method="lm", se=FALSE)+labs(x="Teoriniai kvantiliai", y = "Matematikos rezultatas")
pdf("Output/teorkv.pdf", width = 10)
p
dev.off()
varbs <- c("IDSTUD", "IDSCHOOL", "IDCLASS", "SSEX", "STHMWRK2", "SMENG", "SMCONF",
"SMVALUE",
"MSMENG", "MSMCONF", "MSMVALUE", "CSMENG", "CSMCONF", "CSMVALUE",
"SMLIKE", "SBULLED", "SHEDRES",
"CSMLIKE", "CSBULLED", "CSHEDRES",
"MSMLIKE", "MSBULLED", "MSHEDRES",
"MDYDIS", "MSUDET2", "MSUDET.1", "MSUDET.2",
"MSUDET.3", "MAINCOME", "MAINCOME.1",
"MAINCOME.2", "MAINCOME.3", "MVIETA2", "MVIETA.1", "MVIETA.2",
"MVIETA.3", "MSUCCESS",#"MMATSHORT",
"MVIETA.4", "MVIETA.5",
"STUDWGT", "SCHWGT", "TOTWGT", "WGTADJ1", "WGTADJ2", "WGTADJ3",
"WGTFAC1", "WGTFAC2", "WGTFAC3", "IDSTRATE")
data.2011 <- drop.levels(na.omit(data.2011[,c("BSMMAT01", varbs), with = F]))
lme.0 <-lmer(BSMMAT01 ~ 1+(1|IDSCHOOL), data = data.2011, REML = T)
(sm0 <- summary(lme.0))
c0 <- confint(lme.0, method = "boot")
c0[1:2, ] <- c0[1:2, ]^2
rb01 <- try(bootREML(data = data.2011, R = 500,
form = "BSMMAT01 ~ 1+
(1|IDSCHOOL)", idstrata = "IDSTRATE"))
rb01 <- try(bootREML(data = data.2011, R = 5,
form = "BSMMAT01 ~ 1+
(1|IDSCHOOL)", idstrata = "IDSTRATE"))
varbs <- c("IDSTUD", "IDSCHOOL", "IDCLASS", "SSEX", "STHMWRK2", "MVIETA.5",
"CSMCONF", "CSHEDRES", "MDYDIS", "CSHEDRES",
"CSBULLED", "MVIETA.3", "MSUCCESS", "MVIETA.4",
"MSMLIKE", "MSHEDRES", "MAINCOME.1",
"STUDWGT", "SCHWGT", "TOTWGT", "WGTADJ1", "WGTADJ2", "WGTADJ3",
"WGTFAC1", "WGTFAC2", "WGTFAC3", "IDSTRATE")
data.2011 <- drop.levels(na.omit(data.2011[,c("BSMMAT01", varbs), with = F]))
mw1 <- try(bootMINQUE2(data = data.2011, R = 2,
fixed = "BSMMAT01 ~ 1+SSEX+STHMWRK2:MVIETA.5+
CSMCONF+CSHEDRES*MDYDIS+CSHEDRES:MVIETA.5+
CSBULLED:MVIETA.3+MDYDIS+MSUCCESS:MVIETA.4+
MSMLIKE:MVIETA.5+MSMLIKE:MVIETA.4+
MSHEDRES+MAINCOME.1+MVIETA.4",
random="~1+CSHEDRES+CSMCONF|IDSCHOOL", idstrata = "IDSTRATE", wgt = NULL))
rm(list = ls())
library(nlme)
library(plyr)
library(gdata)
library(lme4)
library(mitools)
library(lmerTest)
library(robustlmm)
library(foreach)
library(Matrix)
library(gtools)
library(snow)
library(matrixcalc)
library(mitools)
library(MASS)
library(snow)
library(boot)
library(plyr)
library(mvtnorm)
library(expm)
library(simFrame)
library(foreach)
library(msm)
library(gtools)
library(MASS)
library(lme4)
library(gdata)
library(Matrix)
library(data.table)
library(ggplot2)
source("10code.R")
load("data.2011.RData")
############################################################################
varb <- c("IDSTUD", "IDSCHOOL", "IDCLASS", "SSEX", "STHMWRK2", "SMENG", "SMCONF", "SMVALUE",
"MSMENG", "MSMCONF", "MSMVALUE", "CSMENG", "CSMCONF", "CSMVALUE",
"SMLIKE", "SBULLED", "SHEDRES", "TPROBL", "TAKADSEKM", "TMOKAPL", "KDYDIS",
"CSMLIKE", "CSBULLED", "CSHEDRES", "MKDYDIS", "MKITKALB2",
"MSMLIKE", "MSBULLED", "MSHEDRES", "MTPROBL", "MTAKADSEKM", "MTMOKAPL", "MKDYDIS",
"TSATISF", "TBENDR", "TENGAGE", "TLYTIS", "TISSIL2", "TISSIL.1",
"MTSATISF", "MTBENDR", "MTENGAGE",
"TISSIL.2", "TISSIL.3", "TPATIR", "TAMZIUS2", "TAMZIUS.1", "TAMZIUS.2",
"TAMZIUS.3", "KDYDIS", "MDYDIS", "MSUDET2", "MSUDET.1", "MSUDET.2",
"MSUDET.3", "MDISSAFE", "MSUCCESS", "MMATSHORT", "MAINCOME", "MAINCOME.1",
"MAINCOME.2", "MAINCOME.3", "MVIETA2", "MVIETA.1", "MVIETA.2", "MVIETA.3",
"MVIETA.4", "MVIETA.5", "MKITKALB2", "MKITKALB.1", "MKITKALB.2", "MKITKALB.3",
"MINSTRHWR", "STUDWGT", "SCHWGT", "TOTWGT", "WGTADJ1", "WGTADJ2", "WGTADJ3",
"WGTFAC1", "WGTFAC2", "WGTFAC3", "IDSTRATE")
data.2011 <- data.2011[,c("BSMMAT01", varb), , with = F]
min1 <- myMINQUE2(dt = data.2011,
fixed = "BSMMAT01 ~ 1",
random1 = "~1|IDSCHOOL",
weights = c("STUDWGT", "SCHWGT"))
rm(list = ls())
library(nlme)
library(plyr)
library(gdata)
library(lme4)
library(mitools)
library(lmerTest)
library(robustlmm)
library(foreach)
library(Matrix)
library(gtools)
library(snow)
library(matrixcalc)
library(mitools)
library(MASS)
library(snow)
library(boot)
library(plyr)
library(mvtnorm)
library(expm)
library(simFrame)
library(foreach)
library(msm)
library(gtools)
library(MASS)
library(lme4)
library(gdata)
library(Matrix)
library(data.table)
library(ggplot2)
source("10code.R")
load("data.2011.RData")
############################################################################
varb <- c("IDSTUD", "IDSCHOOL", "IDCLASS", "SSEX", "STHMWRK2", "SMENG", "SMCONF", "SMVALUE",
"MSMENG", "MSMCONF", "MSMVALUE", "CSMENG", "CSMCONF", "CSMVALUE",
"SMLIKE", "SBULLED", "SHEDRES", "TPROBL", "TAKADSEKM", "TMOKAPL", "KDYDIS",
"CSMLIKE", "CSBULLED", "CSHEDRES", "MKDYDIS", "MKITKALB2",
"MSMLIKE", "MSBULLED", "MSHEDRES", "MTPROBL", "MTAKADSEKM", "MTMOKAPL", "MKDYDIS",
"TSATISF", "TBENDR", "TENGAGE", "TLYTIS", "TISSIL2", "TISSIL.1",
"MTSATISF", "MTBENDR", "MTENGAGE",
"TISSIL.2", "TISSIL.3", "TPATIR", "TAMZIUS2", "TAMZIUS.1", "TAMZIUS.2",
"TAMZIUS.3", "KDYDIS", "MDYDIS", "MSUDET2", "MSUDET.1", "MSUDET.2",
"MSUDET.3", "MDISSAFE", "MSUCCESS", "MMATSHORT", "MAINCOME", "MAINCOME.1",
"MAINCOME.2", "MAINCOME.3", "MVIETA2", "MVIETA.1", "MVIETA.2", "MVIETA.3",
"MVIETA.4", "MVIETA.5", "MKITKALB2", "MKITKALB.1", "MKITKALB.2", "MKITKALB.3",
"MINSTRHWR", "STUDWGT", "SCHWGT", "TOTWGT", "WGTADJ1", "WGTADJ2", "WGTADJ3",
"WGTFAC1", "WGTFAC2", "WGTFAC3", "IDSTRATE")
data.2011 <- data.2011[,c("BSMMAT01", varb), , with = F]
min1 <- myMINQUE2(dt = data.2011,
fixed = "BSMMAT01 ~ 1",
random1 = "~1|IDSCHOOL",
weights = c("STUDWGT", "SCHWGT"))
gc()
min1
